{"version":3,"sources":["../es6/venta/ventaRegistrarController.js"],"names":["VentaController","service","ui","clienteService","productoService","lstProductos","lstClientes","tipoBusqueda","lstDetalles","prodSeleccionado","cliSeleccionado","descuento","muestraProductos","listar","data","titulo","cabecera","filas","map","prod","Descripcion","Precio","AthenasNet","formatPrecio","PrecioVenta","Stock","StockActual","Descuento","Categoria","Id","setModalBuscarData","console","log","muestraClientes","listarCliente","cli","Nombre","Apellido","Dni","Telefono","evtBtnBuscarProducto","getBtnBuscarProducto","addEventListener","evtBtnBuscarCliente","getBtnBuscarCliente","evtAbreModal","getModalBuscar","on","e","evtBtnSelModalBuscar","getModalContentBuscar","target","dataset","seleccionId","id","parseInt","find","setProducto","Codigo","formatCodigo","modal","setCliente","evtBtnAgregarDet","getBtnAgregarDet","cantidad","getInputCantidad","value","encontrado","i","length","Producto","Cantidad","push","DesctUni","muestraDetalle","evtEliminaDetalle","getTblDetalle","productoId","filter","det","subtotal","total","SubTotal","setDetalleData","setSubTotal","toFixed","setDescuento","setTotal","evtFormVenta","getFormVenta","preventDefault","venta","Cliente","Detalles","crear","mensaje","color","texto","localStorage","setItem","JSON","stringify","window","location","href","MVC_URL_BASE","error","iniciar"],"mappings":";;;;;;;;;;;;AAAC,IAAMA,eAAe,GAAG,SAAlBA,eAAkB,CAACC,OAAD,EAAUC,EAAV,EAAcC,cAAd,EAA8BC,eAA9B,EAAkD;AACvE,MAAIC,YAAY,GAAG,EAAnB;AACA,MAAIC,WAAW,GAAG,EAAlB;AACA,MAAIC,YAAY,GAAG,IAAnB,CAHuE,CAG/C;;AACxB,MAAIC,WAAW,GAAG,EAAlB;AACA,MAAIC,gBAAgB,GAAG,EAAvB;AACA,MAAIC,eAAe,GAAG,EAAtB;AACA,MAAIC,SAAS,GAAG,CAAhB;;AAEA,MAAMC,gBAAgB;AAAA,uEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACAR,eAAe,CAACS,MAAhB,CAAuB,EAAvB,CADA;;AAAA;AACrBR,cAAAA,YADqB;AAEfS,cAAAA,IAFe,GAER;AACTC,gBAAAA,MAAM,EAAE,iBADC;AAETC,gBAAAA,QAAQ,EAAE,CACN,aADM,EAEN,QAFM,EAGN,OAHM,EAIN,WAJM,EAKN,WALM,EAMN,UANM,CAFD;AAUTC,gBAAAA,KAAK,EAAEZ,YAAY,CAACa,GAAb,CAAiB,UAAAC,IAAI,EAAI;AAE5B,yBAAO;AACHL,oBAAAA,IAAI,EAAE;AACFM,sBAAAA,WAAW,EAAED,IAAI,CAACC,WADhB;AAEFC,sBAAAA,MAAM,EAAEC,UAAU,CAACC,YAAX,CAAwBJ,IAAI,CAACK,WAA7B,CAFN;AAGFC,sBAAAA,KAAK,EAAEN,IAAI,CAACO,WAHV;AAIFC,sBAAAA,SAAS,EAAEL,UAAU,CAACC,YAAX,CAAwBJ,IAAI,CAACQ,SAA7B,CAJT;AAKFC,sBAAAA,SAAS,EAAET,IAAI,CAACS,SAAL,CAAeR;AALxB,qBADH;AAQHS,oBAAAA,EAAE,EAAEV,IAAI,CAACU;AARN,mBAAP;AAWH,iBAbM;AAVE,eAFQ;AA4BrB3B,cAAAA,EAAE,CAAC4B,kBAAH,CAAsBhB,IAAtB;AACAiB,cAAAA,OAAO,CAACC,GAAR,CAAY3B,YAAZ;;AA7BqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAhBO,gBAAgB;AAAA;AAAA;AAAA,KAAtB;;AAgCA,MAAMqB,eAAe;AAAA,wEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACA9B,cAAc,CAAC+B,aAAf,CAA6B,EAA7B,CADA;;AAAA;AACpB5B,cAAAA,WADoB;AAEdQ,cAAAA,IAFc,GAEP;AACTC,gBAAAA,MAAM,EAAE,gBADC;AAETC,gBAAAA,QAAQ,EAAE,CACN,iBADM,EAEN,KAFM,EAGN,UAHM,EAIN,UAJM,CAFD;AAQTC,gBAAAA,KAAK,EAAEX,WAAW,CAACY,GAAZ,CAAgB,UAAAiB,GAAG,EAAI;AAE1B,yBAAO;AACHrB,oBAAAA,IAAI,EAAE;AACFsB,sBAAAA,MAAM,EAAED,GAAG,CAACC,MAAJ,GAAa,GAAb,GAAmBD,GAAG,CAACE,QAD7B;AAEFC,sBAAAA,GAAG,EAAEH,GAAG,CAACG,GAFP;AAGFC,sBAAAA,QAAQ,EAAEJ,GAAG,CAACI;AAHZ,qBADH;AAMHV,oBAAAA,EAAE,EAAEM,GAAG,CAACN;AANL,mBAAP;AASH,iBAXM;AARE,eAFO;AAuBpB3B,cAAAA,EAAE,CAAC4B,kBAAH,CAAsBhB,IAAtB;AACAiB,cAAAA,OAAO,CAACC,GAAR,CAAY1B,WAAZ;;AAxBoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAf2B,eAAe;AAAA;AAAA;AAAA,KAArB;;AA2BA,MAAMO,oBAAoB,GAAG,SAAvBA,oBAAuB;AAAA,WAAMtC,EAAE,CAACuC,oBAAH,GAA0BC,gBAA1B,CAA2C,OAA3C,EAAoD;AAAA,aAAMnC,YAAY,GAAG,UAArB;AAAA,KAApD,CAAN;AAAA,GAA7B;;AAEA,MAAMoC,mBAAmB,GAAG,SAAtBA,mBAAsB;AAAA,WAAMzC,EAAE,CAAC0C,mBAAH,GAAyBF,gBAAzB,CAA0C,OAA1C,EAAmD;AAAA,aAAMnC,YAAY,GAAG,SAArB;AAAA,KAAnD,CAAN;AAAA,GAA5B;;AAEA,MAAMsC,YAAY,GAAG,SAAfA,YAAe,GAAM;AACvB3C,IAAAA,EAAE,CAAC4C,cAAH,GAAoBC,EAApB,CAAuB,eAAvB,EAAwC,UAACC,CAAD,EAAO;AAC3C,UAAIzC,YAAY,KAAK,UAArB,EAAiCK,gBAAgB,GAAjD,KACKqB,eAAe;AACvB,KAHD;AAIH,GALD;;AAOA,MAAMgB,oBAAoB,GAAG,SAAvBA,oBAAuB,GAAM;AAE/B/C,IAAAA,EAAE,CAACgD,qBAAH,GAA2BR,gBAA3B,CAA4C,OAA5C,EAAqD,UAACM,CAAD,EAAO;AAExD,UAAIA,CAAC,CAACG,MAAF,CAASC,OAAT,CAAiBC,WAArB,EAAkC;AAE9BtB,QAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AAEA,YAAMsB,EAAE,GAAGC,QAAQ,CAACP,CAAC,CAACG,MAAF,CAASC,OAAT,CAAiBC,WAAlB,CAAnB;;AAEA,YAAI9C,YAAY,KAAK,UAArB,EAAiC;AAE7BE,UAAAA,gBAAgB,GAAGJ,YAAY,CAACmD,IAAb,CAAkB,UAAArC,IAAI;AAAA,mBAAIA,IAAI,CAACU,EAAL,KAAYyB,EAAhB;AAAA,WAAtB,CAAnB;AAEApD,UAAAA,EAAE,CAACuD,WAAH,iCACOhD,gBADP;AAEIe,YAAAA,WAAW,EAAEF,UAAU,CAACC,YAAX,CAAwBd,gBAAgB,CAACe,WAAzC,CAFjB;AAGIG,YAAAA,SAAS,EAAEL,UAAU,CAACC,YAAX,CAAwBd,gBAAgB,CAACkB,SAAzC,CAHf;AAII+B,YAAAA,MAAM,EAAEpC,UAAU,CAACqC,YAAX,CAAwBlD,gBAAgB,CAACoB,EAAzC,EAA6C,KAA7C,EAAoD,CAApD;AAJZ;AAMA3B,UAAAA,EAAE,CAAC4C,cAAH,GAAoBc,KAApB,CAA0B,MAA1B;AACH,SAXD,MAYK;AACDlD,UAAAA,eAAe,GAAGJ,WAAW,CAACkD,IAAZ,CAAiB,UAAArB,GAAG;AAAA,mBAAIA,GAAG,CAACN,EAAJ,KAAWyB,EAAf;AAAA,WAApB,CAAlB;AAEApD,UAAAA,EAAE,CAAC2D,UAAH,CAAcnD,eAAd;AACAR,UAAAA,EAAE,CAAC4C,cAAH,GAAoBc,KAApB,CAA0B,MAA1B;AACH;AAEJ;AAEJ,KA7BD;AA+BH,GAjCD;;AAmCA,MAAME,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;AAE3B5D,IAAAA,EAAE,CAAC6D,gBAAH,GAAsBrB,gBAAtB,CAAuC,OAAvC,EAAgD,YAAM;AAElD,UAAMsB,QAAQ,GAAG9D,EAAE,CAAC+D,gBAAH,GAAsBC,KAAvC;AAEA,UAAIC,UAAU,GAAG,KAAjB;;AAEA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG5D,WAAW,CAAC6D,MAAhC,EAAwCD,CAAC,EAAzC,EAA6C;AAEzC,YAAI3D,gBAAgB,CAACoB,EAAjB,KAAwBrB,WAAW,CAAC4D,CAAD,CAAX,CAAeE,QAAf,CAAwBzC,EAApD,EAAwD;AAEpDrB,UAAAA,WAAW,CAAC4D,CAAD,CAAX,CAAeG,QAAf,GAA0BhB,QAAQ,CAACS,QAAD,CAAlC;AAEAG,UAAAA,UAAU,GAAG,IAAb;AACA;AACH;AAEJ;;AAED,UAAI,CAACA,UAAL,EAAiB;AACb3D,QAAAA,WAAW,CAACgE,IAAZ,CAAiB;AAEbF,UAAAA,QAAQ,EAAE;AACNzC,YAAAA,EAAE,EAAEpB,gBAAgB,CAACoB,EADf;AAENT,YAAAA,WAAW,EAAEX,gBAAgB,CAACW;AAFxB,WAFG;AAMbmD,UAAAA,QAAQ,EAAEhB,QAAQ,CAACS,QAAD,CANL;AAOb3C,UAAAA,MAAM,EAAEZ,gBAAgB,CAACe,WAPZ;AAQbiD,UAAAA,QAAQ,EAAEhE,gBAAgB,CAACkB;AARd,SAAjB;AAWH;;AAGD+C,MAAAA,cAAc;AACjB,KAlCD;AAoCH,GAtCD;;AAwCA,MAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,GAAM;AAE5BzE,IAAAA,EAAE,CAAC0E,aAAH,GAAmBlC,gBAAnB,CAAoC,OAApC,EAA6C,UAACM,CAAD,EAAO;AAEhD,UAAIA,CAAC,CAACG,MAAF,CAASC,OAAT,CAAiByB,UAArB,EAAiC;AAC7B,YAAMvB,EAAE,GAAGC,QAAQ,CAACP,CAAC,CAACG,MAAF,CAASC,OAAT,CAAiByB,UAAlB,CAAnB;AAEArE,QAAAA,WAAW,GAAGA,WAAW,CAACsE,MAAZ,CAAmB,UAAAC,GAAG;AAAA,iBAAIA,GAAG,CAACT,QAAJ,CAAazC,EAAb,KAAoByB,EAAxB;AAAA,SAAtB,CAAd;AACAoB,QAAAA,cAAc;AAGjB;AAEJ,KAXD;AAaH,GAfD;;AAkBA,MAAMA,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AACzB,QAAIM,QAAQ,GAAG,CAAf;AAEA,QAAIC,KAAK,GAAG,CAAZ;AAGA,QAAMnE,IAAI,GAAG;AAETG,MAAAA,KAAK,EAAET,WAAW,CAACU,GAAZ,CAAgB,UAAA6D,GAAG,EAAI;AAE1BC,QAAAA,QAAQ,IAAIzB,QAAQ,CAACwB,GAAG,CAACR,QAAL,CAAR,GAAyBQ,GAAG,CAAC1D,MAAzC;AACAV,QAAAA,SAAS,IAAI4C,QAAQ,CAACwB,GAAG,CAACR,QAAL,CAAR,GAAyBQ,GAAG,CAACN,QAA1C;AACAQ,QAAAA,KAAK,IAAI1B,QAAQ,CAACwB,GAAG,CAACR,QAAL,CAAR,GAAyBQ,GAAG,CAAC1D,MAA7B,GAAsCkC,QAAQ,CAACwB,GAAG,CAACR,QAAL,CAAR,GAAyBQ,GAAG,CAACN,QAA5E;AAGA,eAAO;AACH3D,UAAAA,IAAI,EAAE;AACF4C,YAAAA,MAAM,EAAEpC,UAAU,CAACqC,YAAX,CAAwBoB,GAAG,CAACT,QAAJ,CAAazC,EAArC,EAAyC,KAAzC,EAAgD,CAAhD,CADN;AAEFT,YAAAA,WAAW,EAAE2D,GAAG,CAACT,QAAJ,CAAalD,WAFxB;AAGFC,YAAAA,MAAM,EAAEC,UAAU,CAACC,YAAX,CAAwBwD,GAAG,CAAC1D,MAA5B,CAHN;AAIFkD,YAAAA,QAAQ,EAAEQ,GAAG,CAACR,QAJZ;AAKFW,YAAAA,QAAQ,EAAE5D,UAAU,CAACC,YAAX,CAAwBwD,GAAG,CAAC1D,MAAJ,GAAa0D,GAAG,CAACR,QAAzC,CALR;AAMF5C,YAAAA,SAAS,EAAEL,UAAU,CAACC,YAAX,CAAwBwD,GAAG,CAACN,QAAJ,GAAeM,GAAG,CAACR,QAA3C;AANT,WADH;AASHM,UAAAA,UAAU,EAAEE,GAAG,CAACT,QAAJ,CAAazC;AATtB,SAAP;AAYH,OAnBM;AAFE,KAAb;AAwBA3B,IAAAA,EAAE,CAACiF,cAAH,CAAkBrE,IAAlB;AACAZ,IAAAA,EAAE,CAACkF,WAAH,CAAeJ,QAAQ,CAACK,OAAT,CAAiB,CAAjB,CAAf;AACAnF,IAAAA,EAAE,CAACoF,YAAH,CAAgB3E,SAAS,CAAC0E,OAAV,CAAkB,CAAlB,CAAhB;AACAnF,IAAAA,EAAE,CAACqF,QAAH,CAAYN,KAAK,CAACI,OAAN,CAAc,CAAd,CAAZ;AACH,GAlCD;;AAqCA,MAAMG,YAAY,GAAG,SAAfA,YAAe,GAAM;AAEvBtF,IAAAA,EAAE,CAACuF,YAAH,GAAkB/C,gBAAlB,CAAmC,QAAnC;AAAA,0EAA6C,kBAAOM,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAEzCA,gBAAAA,CAAC,CAAC0C,cAAF;AAEMC,gBAAAA,KAJmC,GAI3B;AACVC,kBAAAA,OAAO,EAAE;AACL/D,oBAAAA,EAAE,EAAEnB,eAAe,CAACmB;AADf,mBADC;AAIVgE,kBAAAA,QAAQ,EAAErF,WAJA;AAKVmB,kBAAAA,SAAS,EAAEhB;AALD,iBAJ2B;AAAA;AAAA;AAAA,uBAY/BV,OAAO,CAAC6F,KAAR,CAAcH,KAAd,CAZ+B;;AAAA;AAa/BI,gBAAAA,OAb+B,GAarB;AACZC,kBAAAA,KAAK,EAAE,YADK;AAEZjF,kBAAAA,MAAM,EAAE,kBAFI;AAGZkF,kBAAAA,KAAK,EAAE;AAHK,iBAbqB;AAkBrCC,gBAAAA,YAAY,CAACC,OAAb,CAAqB,SAArB,EAAgCC,IAAI,CAACC,SAAL,CAAeN,OAAf,CAAhC;AACAO,gBAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuBlF,UAAU,CAACmF,YAAX,GAA0B,OAAjD;AAnBqC;AAAA;;AAAA;AAAA;AAAA;AAsBrC1E,gBAAAA,OAAO,CAAC2E,KAAR;;AAtBqC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA7C;;AAAA;AAAA;AAAA;AAAA;AA2BH,GA7BD;;AA+BA,MAAMC,OAAO,GAAG,SAAVA,OAAU,GAAM;AAClBnE,IAAAA,oBAAoB;AACpBG,IAAAA,mBAAmB;AACnBE,IAAAA,YAAY;AACZI,IAAAA,oBAAoB;AACpBa,IAAAA,gBAAgB;AAChBa,IAAAA,iBAAiB;AACjBa,IAAAA,YAAY;AACf,GARD;;AAUA,SAAO;AACHmB,IAAAA,OAAO,EAAPA;AADG,GAAP;AAGH,CA7PA","sourcesContent":["﻿const VentaController = (service, ui, clienteService, productoService) => {\r\n    let lstProductos = [];\r\n    let lstClientes = [];\r\n    let tipoBusqueda = null;//Producto, Cliente\r\n    let lstDetalles = [];\r\n    let prodSeleccionado = {};\r\n    let cliSeleccionado = {};\r\n    let descuento = 0;\r\n\r\n    const muestraProductos = async () => {\r\n        lstProductos = await productoService.listar({});\r\n        const data = {\r\n            titulo: 'Buscar Producto',\r\n            cabecera: [\r\n                'Descripción',\r\n                'Precio',\r\n                'Stock',\r\n                'Descuento',\r\n                'Categoría',\r\n                'Acciones'\r\n            ],\r\n            filas: lstProductos.map(prod => {\r\n\r\n                return {\r\n                    data: {\r\n                        Descripcion: prod.Descripcion,\r\n                        Precio: AthenasNet.formatPrecio(prod.PrecioVenta),\r\n                        Stock: prod.StockActual,\r\n                        Descuento: AthenasNet.formatPrecio(prod.Descuento),\r\n                        Categoria: prod.Categoria.Descripcion\r\n                    },\r\n                    Id: prod.Id\r\n                }\r\n\r\n            })\r\n        }\r\n\r\n        ui.setModalBuscarData(data);\r\n        console.log(lstProductos)\r\n    }\r\n\r\n    const muestraClientes = async () => {\r\n        lstClientes = await clienteService.listarCliente({});\r\n        const data = {\r\n            titulo: 'Buscar Cliente',\r\n            cabecera: [\r\n                'Nombre Completo',\r\n                'Dni',\r\n                'Teléfono',\r\n                'Acciones'\r\n            ],\r\n            filas: lstClientes.map(cli => {\r\n\r\n                return {\r\n                    data: {\r\n                        Nombre: cli.Nombre + ' ' + cli.Apellido ,\r\n                        Dni: cli.Dni,\r\n                        Telefono: cli.Telefono\r\n                    },\r\n                    Id: cli.Id\r\n                }\r\n\r\n            })\r\n        }\r\n        ui.setModalBuscarData(data);\r\n        console.log(lstClientes)\r\n    }\r\n\r\n    const evtBtnBuscarProducto = () => ui.getBtnBuscarProducto().addEventListener('click', () => tipoBusqueda = 'Producto');\r\n\r\n    const evtBtnBuscarCliente = () => ui.getBtnBuscarCliente().addEventListener('click', () => tipoBusqueda = 'Cliente');\r\n\r\n    const evtAbreModal = () => {\r\n        ui.getModalBuscar().on('show.bs.modal', (e) => {\r\n            if (tipoBusqueda === 'Producto') muestraProductos();\r\n            else muestraClientes();\r\n        })\r\n    }\r\n\r\n    const evtBtnSelModalBuscar = () => {\r\n\r\n        ui.getModalContentBuscar().addEventListener('click', (e) => {\r\n\r\n            if (e.target.dataset.seleccionId) {\r\n\r\n                console.log('click de seleccion');\r\n\r\n                const id = parseInt(e.target.dataset.seleccionId);\r\n\r\n                if (tipoBusqueda === 'Producto') {\r\n\r\n                    prodSeleccionado = lstProductos.find(prod => prod.Id === id);\r\n\r\n                    ui.setProducto({\r\n                        ...prodSeleccionado,\r\n                        PrecioVenta: AthenasNet.formatPrecio(prodSeleccionado.PrecioVenta),\r\n                        Descuento: AthenasNet.formatPrecio(prodSeleccionado.Descuento),\r\n                        Codigo: AthenasNet.formatCodigo(prodSeleccionado.Id, 'PRD', 4)\r\n                    });\r\n                    ui.getModalBuscar().modal('hide');\r\n                }\r\n                else {\r\n                    cliSeleccionado = lstClientes.find(cli => cli.Id === id);\r\n\r\n                    ui.setCliente(cliSeleccionado);\r\n                    ui.getModalBuscar().modal('hide');\r\n                }\r\n\r\n            }\r\n\r\n        })\r\n\r\n    }\r\n\r\n    const evtBtnAgregarDet = () => {\r\n\r\n        ui.getBtnAgregarDet().addEventListener('click', () => {\r\n\r\n            const cantidad = ui.getInputCantidad().value;\r\n\r\n            let encontrado = false;\r\n\r\n            for (let i = 0; i < lstDetalles.length; i++) {\r\n\r\n                if (prodSeleccionado.Id === lstDetalles[i].Producto.Id) {\r\n\r\n                    lstDetalles[i].Cantidad = parseInt(cantidad);\r\n\r\n                    encontrado = true;\r\n                    break;\r\n                }\r\n\r\n            }\r\n\r\n            if (!encontrado) {\r\n                lstDetalles.push({\r\n\r\n                    Producto: {\r\n                        Id: prodSeleccionado.Id,\r\n                        Descripcion: prodSeleccionado.Descripcion\r\n                    },\r\n                    Cantidad: parseInt(cantidad),\r\n                    Precio: prodSeleccionado.PrecioVenta,\r\n                    DesctUni: prodSeleccionado.Descuento\r\n\r\n                });\r\n            }\r\n\r\n\r\n            muestraDetalle();\r\n        })\r\n\r\n    }\r\n\r\n    const evtEliminaDetalle = () => {\r\n\r\n        ui.getTblDetalle().addEventListener('click', (e) => {\r\n\r\n            if (e.target.dataset.productoId) {\r\n                const id = parseInt(e.target.dataset.productoId);\r\n\r\n                lstDetalles = lstDetalles.filter(det => det.Producto.Id !== id);\r\n                muestraDetalle();\r\n\r\n\r\n            }\r\n\r\n        })\r\n\r\n    }\r\n    \r\n\r\n    const muestraDetalle = () => {\r\n        let subtotal = 0;\r\n        \r\n        let total = 0;\r\n        \r\n\r\n        const data = {\r\n\r\n            filas: lstDetalles.map(det => {\r\n\r\n                subtotal += parseInt(det.Cantidad) * det.Precio;\r\n                descuento += parseInt(det.Cantidad) * det.DesctUni;\r\n                total += parseInt(det.Cantidad) * det.Precio - parseInt(det.Cantidad) * det.DesctUni;\r\n\r\n\r\n                return {\r\n                    data: {\r\n                        Codigo: AthenasNet.formatCodigo(det.Producto.Id, 'PRD', 4),\r\n                        Descripcion: det.Producto.Descripcion,\r\n                        Precio: AthenasNet.formatPrecio(det.Precio),\r\n                        Cantidad: det.Cantidad,\r\n                        SubTotal: AthenasNet.formatPrecio(det.Precio * det.Cantidad),\r\n                        Descuento: AthenasNet.formatPrecio(det.DesctUni * det.Cantidad)\r\n                    },\r\n                    productoId: det.Producto.Id\r\n                }\r\n                \r\n            })\r\n        }\r\n\r\n        ui.setDetalleData(data);\r\n        ui.setSubTotal(subtotal.toFixed(2));\r\n        ui.setDescuento(descuento.toFixed(2));\r\n        ui.setTotal(total.toFixed(2));\r\n    }\r\n\r\n    \r\n    const evtFormVenta = () => {\r\n\r\n        ui.getFormVenta().addEventListener('submit', async (e) => {\r\n\r\n            e.preventDefault();\r\n\r\n            const venta = {\r\n                Cliente: {\r\n                    Id: cliSeleccionado.Id\r\n                },\r\n                Detalles: lstDetalles,\r\n                Descuento: descuento\r\n            }\r\n            try {\r\n                await service.crear(venta)\r\n                const mensaje = {\r\n                    color: 'bg-success',\r\n                    titulo: 'Registro exitoso',\r\n                    texto: 'La venta fue registrado exitosamente'\r\n                }\r\n                localStorage.setItem('mensaje', JSON.stringify(mensaje));\r\n                window.location.href = AthenasNet.MVC_URL_BASE + 'Venta';\r\n            }\r\n            catch (err) {\r\n                console.error(err);\r\n            }\r\n\r\n        })\r\n\r\n    }\r\n\r\n    const iniciar = () => {\r\n        evtBtnBuscarProducto();\r\n        evtBtnBuscarCliente();\r\n        evtAbreModal();\r\n        evtBtnSelModalBuscar();\r\n        evtBtnAgregarDet();\r\n        evtEliminaDetalle();\r\n        evtFormVenta();\r\n    }\r\n\r\n    return {\r\n        iniciar\r\n    }\r\n}"],"file":"ventaRegistrarController.js"}