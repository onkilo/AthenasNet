{"version":3,"sources":["../es6/athenasNet.js"],"names":["MVC_URL_BASE","window","location","protocol","host","ACCION_MOSTRAR_SPINNER","ACCION_OCULTAR_SPINNER","SEL_MODAL_CONF","ID_FORM_CONFIRMAR","ID_TEMP_TBL_BODY","llamadaApi","opciones","opcionsDefecto","beforeSend","manejaSpinner","contentType","data","type","$","ajax","url","respuesta","Codigo","urlActual","href","muestraToast","cssClass","mensaje","titulo","estado","spinner","document","querySelector","style","display","SEL_TOAST","SEL_TOAST_TITULO","SEL_TOAST_MENSAJE","toast","clases","push","className","join","innerHTML","compilaTemplate","idTemplate","selObjetivo","htmlTemplate","getElementById","template","Handlebars","compile","compTemplate","getFormConfirmar","mostrarConfirmacion","modal","ocultarConfirmacion","formatFecha","fecha","arrElementos","split","newFecha","reverse","formatPrecio","precio","toFixed","formatCodigo","id","iniFormato","cantNum","formato","cantCeros","toString","length","i","AthenasNet","registerHelper","key","addEventListener","extend","fn","dataTable","defaults"],"mappings":"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","sourcesContent":["(function () {\r\n\r\n    const MVC_URL_BASE = `${window.location.protocol}//${window.location.host}/`;\r\n    const ACCION_MOSTRAR_SPINNER = 'mostrar';\r\n    const ACCION_OCULTAR_SPINNER = 'ocultar';\r\n    const SEL_MODAL_CONF = '#modal-confirmar';\r\n    const ID_FORM_CONFIRMAR = 'form-confirmar';\r\n    const ID_TEMP_TBL_BODY = 'temp-tbl-body';\r\n\r\n    const llamadaApi = async (opciones) => {\r\n\r\n        const opcionsDefecto = {\r\n            beforeSend: function () {\r\n                manejaSpinner(ACCION_MOSTRAR_SPINNER);\r\n            },\r\n            contentType: 'application/json',\r\n            data: {},\r\n            type: 'GET'\r\n        };\r\n        \r\n        \r\n        try {\r\n            const respuesta = await $.ajax({\r\n                ...opcionsDefecto,\r\n                ...opciones,\r\n                url: MVC_URL_BASE + opciones.url\r\n            });\r\n\r\n            if (respuesta.Codigo === 401) {\r\n\r\n                const urlActual = window.location.href;\r\n\r\n                window.location.href = MVC_URL_BASE + 'Usuario/Login?redirectUrl=' + urlActual;\r\n                return null;\r\n\r\n            }\r\n\r\n            if (respuesta.Codigo === 403) {\r\n\r\n                muestraToast({\r\n                    cssClass: 'bg-danger',\r\n                    mensaje: 'No tiene permisos para realizar esta acción',\r\n                    titulo: 'Error de autorización'\r\n                })\r\n\r\n            }\r\n\r\n            if (respuesta.Codigo !== 200) {\r\n                throw respuesta;\r\n            }\r\n\r\n            return respuesta;\r\n        }\r\n        catch (err) {\r\n            throw err;\r\n        }\r\n        finally {\r\n            //ocultar spinner\r\n            manejaSpinner(ACCION_OCULTAR_SPINNER);\r\n        }\r\n\r\n    }\r\n\r\n    const manejaSpinner = (estado) => {\r\n\r\n        const spinner = document.querySelector('.spinner-container');\r\n\r\n        if (estado === 'mostrar') spinner.style.display = 'flex';\r\n        else spinner.style.display = 'none';\r\n    }\r\n\r\n    const muestraToast = ({ cssClass = 'bg-success', mensaje = 'Operación exitosa', titulo = 'Éxito' }) => {\r\n\r\n        const SEL_TOAST = '#general-toast';\r\n        const SEL_TOAST_TITULO = '#general-toast #toast-titulo';\r\n        const SEL_TOAST_MENSAJE = '#general-toast #toast-mensaje';\r\n\r\n        const toast = document.querySelector(SEL_TOAST);\r\n\r\n        const clases = ['toast', 'mt-2'];\r\n        clases.push(cssClass);\r\n\r\n        toast.className = clases.join(' ');\r\n\r\n        document.querySelector(SEL_TOAST_TITULO).innerHTML = titulo;\r\n        document.querySelector(SEL_TOAST_MENSAJE).innerHTML = mensaje;\r\n\r\n        $(SEL_TOAST).toast('show');\r\n\r\n    }\r\n\r\n    const compilaTemplate = (idTemplate, data, selObjetivo) => {\r\n\r\n        const htmlTemplate = document.getElementById(idTemplate).innerHTML;\r\n\r\n        const template = Handlebars.compile(htmlTemplate);\r\n\r\n        const compTemplate = template(data);\r\n\r\n        document.querySelector(selObjetivo).innerHTML = compTemplate;\r\n    }\r\n\r\n    const getFormConfirmar = () => document.getElementById(ID_FORM_CONFIRMAR);\r\n\r\n    const mostrarConfirmacion = () => {\r\n        $(SEL_MODAL_CONF).modal('show');\r\n    }\r\n\r\n    const ocultarConfirmacion = () => {\r\n        $(SEL_MODAL_CONF).modal('hide');\r\n    }\r\n\r\n    const formatFecha = (fecha) => {\r\n\r\n        const arrElementos = fecha.split('-');\r\n        const newFecha = arrElementos.reverse().join('/');\r\n        return newFecha;\r\n    }\r\n\r\n    const formatPrecio = (precio) => {\r\n        return `S/. ${precio.toFixed(2)}`;\r\n    }\r\n\r\n    const formatCodigo = (id, iniFormato, cantNum) => {\r\n        let formato = iniFormato;\r\n        const cantCeros = cantNum - id.toString().length;\r\n\r\n        for (let i = 0; i < cantCeros; i++) {\r\n            formato += '0';\r\n        }\r\n\r\n        formato += id.toString();\r\n\r\n        return formato;\r\n    }\r\n\r\n\r\n    window.AthenasNet = {\r\n        llamadaApi,\r\n        manejaSpinner,\r\n        muestraToast,\r\n        compilaTemplate,\r\n        getFormConfirmar,\r\n        mostrarConfirmacion,\r\n        ocultarConfirmacion,\r\n        ID_TEMP_TBL_BODY,\r\n        formatFecha,\r\n        formatPrecio,\r\n        MVC_URL_BASE,\r\n        formatCodigo\r\n    };\r\n})()\r\n\r\n//Handlebars helpers personalizados\r\n//Determina si la propiedad de un objeto es un Id\r\nHandlebars.registerHelper('isId', (key) => {\r\n    return key === 'Id' || key === 'id';\r\n});\r\n\r\n//Formatea el código de los diferentes mantenedores\r\nHandlebars.registerHelper('formatoCodigo', (id, iniFormato, cantNum) => {\r\n    let formato = iniFormato;\r\n    const cantCeros = cantNum - id.toString().length;\r\n\r\n    for (let i = 0; i < cantCeros; i++) {\r\n        formato += '0';\r\n    }\r\n\r\n    formato += id.toString();\r\n\r\n    return formato;\r\n});\r\n\r\n//Da formato de precio a un número\r\nHandlebars.registerHelper('formatoPrecio', ( precio) => {\r\n    return `S/. ${precio.toFixed(2)}`;\r\n})\r\n\r\n\r\n//Fin de los helpers\r\n\r\nwindow.addEventListener('load', () => {\r\n\r\n    $.extend(true, $.fn.dataTable.defaults, {\r\n        \"searching\": false,\r\n        \"ordering\": false,\r\n        \"lengthChange\": false,\r\n        \"language\": {\r\n            \"info\": \"Mostrando página _PAGE_ de _PAGES_\",\r\n            \"paginate\": {\r\n                \"next\": \"Siguiente\",\r\n                \"previous\": \"Anterior\"\r\n            }\r\n        }\r\n    });\r\n\r\n    $('#general-toast').toast();\r\n})\r\n\r\n"],"file":"athenasNet.js"}